import React, {useState, useEffect} from 'react';
import { useNavigation, useRoute } from '@react-navigation/native';
import { View, StyleSheet, TouchableOpacity } from 'react-native';
import { RFValue } from "react-native-responsive-fontsize";
import Svg, { Path } from 'react-native-svg';
import colors from './colors';

// Navbar Komponente
const Navbar = () => {

  const navigation = useNavigation(); // Hook von React Navigation für die Navigation
  const route = useRoute(); // // Zugriff auf die aktuelle Route
  const [activeScreen, setActiveScreen] = useState(route.name); // State für den aktiven Bildschirm

  // Aktualisiert den aktiven Bildschirm, wenn sich die Route ändert
  useEffect(() => {
    const unsubscribe = navigation.addListener('focus', () => {
      setActiveScreen(route.name);
    });

    return unsubscribe;
  }, [navigation, route.name]);

  // Hilfsfunktion, um die Farbe basierend auf dem aktiven Bildschirm zu bestimmen
  const getColorForScreen = (screenName) => {
    return activeScreen === screenName ? colors.black : colors.white;
  };

  // Navigationsfunktionen
  const navigateToDatabase = () => {
    navigation.navigate('DatabaseMenuScreen');
  };

  const navigateToStartScreen = () => {
    navigation.navigate('StartScreen');
  };

  const navigateToAdd = () => {
    navigation.navigate('SelectionScreen');
  };

  const navigateToCalendar = () => {
    navigation.navigate('CalendarScreen');
  };

  return (
    <View style={styles.navbarContainer}>
      <TouchableOpacity style={styles.buttons} onPress={navigateToDatabase}>
        <Svg width={RFValue(30)} height={RFValue(24)} viewBox="0 0 24 24">
            <Path d="M2.63672 4.49878C2.63672 4.10095 2.78723 3.71942 3.05514 3.43812C3.32305 3.15681 3.68641 2.99878 4.06529 2.99878H21.2081C21.587 2.99878 21.9504 3.15681 22.2183 3.43812C22.4862 3.71942 22.6367 4.10095 22.6367 4.49878C22.6367 4.8966 22.4862 5.27813 22.2183 5.55944C21.9504 5.84074 21.587 5.99878 21.2081 5.99878H4.06529C3.68641 5.99878 3.32305 5.84074 3.05514 5.55944C2.78723 5.27813 2.63672 4.8966 2.63672 4.49878ZM2.63672 11.9988C2.63672 11.601 2.78723 11.2194 3.05514 10.9381C3.32305 10.6568 3.68641 10.4988 4.06529 10.4988H21.2081C21.587 10.4988 21.9504 10.6568 22.2183 10.9381C22.4862 11.2194 22.6367 11.601 22.6367 11.9988C22.6367 12.3966 22.4862 12.7781 22.2183 13.0594C21.9504 13.3407 21.587 13.4988 21.2081 13.4988H4.06529C3.68641 13.4988 3.32305 13.3407 3.05514 13.0594C2.78723 12.7781 2.63672 12.3966 2.63672 11.9988ZM2.63672 19.4988C2.63672 19.101 2.78723 18.7194 3.05514 18.4381C3.32305 18.1568 3.68641 17.9988 4.06529 17.9988H21.2081C21.587 17.9988 21.9504 18.1568 22.2183 18.4381C22.4862 18.7194 22.6367 19.101 22.6367 19.4988C22.6367 19.8966 22.4862 20.2781 22.2183 20.5594C21.9504 20.8407 21.587 20.9988 21.2081 20.9988H4.06529C3.68641 20.9988 3.32305 20.8407 3.05514 20.5594C2.78723 20.2781 2.63672 19.8966 2.63672 19.4988Z" fill={getColorForScreen('DatabaseMenuScreen')}/>
        </Svg>
      </TouchableOpacity>
      <TouchableOpacity style={styles.buttons} onPress={navigateToStartScreen}>
        <Svg width={RFValue(30)} height={RFValue(24)} viewBox="0 0 24 24">
            <Path d="M4.63574 5.24957C4.22153 5.24957 3.88574 5.58536 3.88574 5.99957V19.9996C3.88574 20.4138 4.22153 20.7496 4.63574 20.7496H18.6357C19.05 20.7496 19.3857 20.4138 19.3857 19.9996V12.9996C19.3857 12.3092 19.9454 11.7496 20.6357 11.7496C21.3261 11.7496 21.8857 12.3092 21.8857 12.9996V19.9996C21.8857 21.7945 20.4307 23.2496 18.6357 23.2496H4.63574C2.84082 23.2496 1.38574 21.7945 1.38574 19.9996V5.99957C1.38574 4.20465 2.84082 2.74957 4.63574 2.74957H11.6357C12.3261 2.74957 12.8857 3.30922 12.8857 3.99957C12.8857 4.68993 12.3261 5.24957 11.6357 5.24957H4.63574Z" fill={getColorForScreen('StartScreen')}/>
            <Path d="M13.7304 14.3004L20.8783 7.15254L17.4832 3.75746L10.3353 10.9053C10.2369 11.0038 10.167 11.1271 10.1331 11.2622L9.34082 15.2949L13.3728 14.5027C13.5081 14.4688 13.632 14.3988 13.7304 14.3004ZM23.1857 4.84506C23.4741 4.55658 23.6361 4.16537 23.6361 3.75746C23.6361 3.34955 23.4741 2.95834 23.1857 2.66986L21.9659 1.44997C21.6774 1.16158 21.2862 0.999573 20.8783 0.999573C20.4703 0.999573 20.0791 1.16158 19.7907 1.44997L18.5708 2.66986L21.9659 6.06495L23.1857 4.84506Z" fill={getColorForScreen('StartScreen')}/>
        </Svg>
      </TouchableOpacity>
      <TouchableOpacity  style={styles.buttons} onPress={navigateToAdd}>
        <Svg width={RFValue(24)} height={RFValue(24)} viewBox="0 0 24 24">
            <Path d="M14.1397 1.99918C14.1397 1.17075 13.4681 0.499176 12.6397 0.499176C11.8112 0.499176 11.1397 1.17075 11.1397 1.99918V10.4992H2.63965C1.81122 10.4992 1.13965 11.1707 1.13965 11.9992C1.13965 12.8276 1.81122 13.4992 2.63965 13.4992H11.1397V21.9992C11.1397 22.8276 11.8112 23.4992 12.6397 23.4992C13.4681 23.4992 14.1397 22.8276 14.1397 21.9992V13.4992H22.6397C23.4681 13.4992 24.1397 12.8276 24.1397 11.9992C24.1397 11.1707 23.4681 10.4992 22.6397 10.4992H14.1397V1.99918Z" fill={getColorForScreen('SelectionScreen')}/>
        </Svg>
      </TouchableOpacity>
      <TouchableOpacity style={styles.buttons} onPress={navigateToCalendar}>
        <Svg width={RFValue(24)} height={RFValue(24)} viewBox="0 0 24 24">
            <Path d="M3.47012 10.3311C3.24909 10.3311 3.03711 10.2433 2.88082 10.087C2.72452 9.93072 2.63672 9.71874 2.63672 9.49771V2.83215C2.63672 2.61112 2.72452 2.39914 2.88082 2.24285C3.03711 2.08655 3.24909 1.99875 3.47012 1.99875H10.1373C10.3584 1.99875 10.5704 2.08655 10.7266 2.24285C10.8829 2.39914 10.9707 2.61112 10.9707 2.83215V9.49771C10.9707 9.71874 10.8829 9.93072 10.7266 10.087C10.5704 10.2433 10.3584 10.3311 10.1373 10.3311H3.47012ZM15.1378 10.3311C14.9167 10.3311 14.7047 10.2433 14.5485 10.087C14.3922 9.93072 14.3044 9.71874 14.3044 9.49771V2.83215C14.3044 2.61112 14.3922 2.39914 14.5485 2.24285C14.7047 2.08655 14.9167 1.99875 15.1378 1.99875H21.8033C22.0243 1.99875 22.2363 2.08655 22.3926 2.24285C22.5489 2.39914 22.6367 2.61112 22.6367 2.83215V9.49771C22.6367 9.71874 22.5489 9.93072 22.3926 10.087C22.2363 10.2433 22.0243 10.3311 21.8033 10.3311H15.1378ZM3.47012 21.9988C3.24909 21.9988 3.03711 21.9109 2.88082 21.7547C2.72452 21.5984 2.63672 21.3864 2.63672 21.1653V14.4981C2.63672 14.2771 2.72452 14.0651 2.88082 13.9088C3.03711 13.7525 3.24909 13.6647 3.47012 13.6647H10.1373C10.3584 13.6647 10.5704 13.7525 10.7266 13.9088C10.8829 14.0651 10.9707 14.2771 10.9707 14.4981V21.1653C10.9707 21.3864 10.8829 21.5984 10.7266 21.7547C10.5704 21.9109 10.3584 21.9988 10.1373 21.9988H3.47012ZM15.1378 21.9988C14.9167 21.9988 14.7047 21.9109 14.5485 21.7547C14.3922 21.5984 14.3044 21.3864 14.3044 21.1653V14.4981C14.3044 14.2771 14.3922 14.0651 14.5485 13.9088C14.7047 13.7525 14.9167 13.6647 15.1378 13.6647H21.8033C22.0243 13.6647 22.2363 13.7525 22.3926 13.9088C22.5489 14.0651 22.6367 14.2771 22.6367 14.4981V21.1653C22.6367 21.3864 22.5489 21.5984 22.3926 21.7547C22.2363 21.9109 22.0243 21.9988 21.8033 21.9988H15.1378Z" fill={getColorForScreen('CalendarScreen')}/>
        </Svg>
      </TouchableOpacity>
    </View>
  );
};

// Styling der Komponente
const styles = StyleSheet.create({
  navbarContainer: {
    backgroundColor: colors.dermEatsColor,
    width: '100%',
    height: RFValue(70),
    flexDirection: 'row',
    justifyContent: 'space-evenly',
    alignItems: 'center',
  },
  buttons: {
    padding: RFValue(20),
  }
});

export default Navbar;
